webpackJsonp([3],{181:function(e,t,i){function n(e){o||i(372)}var o=!1,s=i(26)(i(380),i(656),n,null,null);s.options.__file="D:\\work\\code\\zhangyingwei\\treehole-jekyll\\treehole-admin\\src\\components\\treehole\\article\\new.vue",s.esModule&&Object.keys(s.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] new.vue: functional components are not supported with templates, they should use render functions."),e.exports=s.exports},372:function(e,t){},380:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(76),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default={data:function(){return{value:"",kinds:[],intervalId:"",info:{title:"",tags:"",kind:null,url:"",allowCommont:!0,id:null},toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,htmlcode:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,subfield:!0,preview:!0},formRules:{required:["title","kind"]}}},methods:{onSave:function(t){var i=this;this.validInfo()&&e.Article.save({id:this.info.id,title:this.info.title,subpath:this.info.url,tags:""===this.info.tags?"":this.info.tags.join(","),categories:this.info.kind,content:this.value,usecommont:this.info.allowCommont?"on":"off"}).then(function(e){console.log(e),e.ok?400==e.code?i.$Message(e.message):(i.info.id=e.result.data,i.$Message("保存成功"),t&&i.$router.replace("/article/history")):i.$Message("服务端错误")})},validInfo:function(){return this.info.title?!!this.info.kind||(this.$Message("请选择文章分类"),!1):(this.$Message("请填写标题"),!1)},submite:function(){var t=this;this.validInfo()&&e.Article.publish({id:this.info.id,title:this.info.title,subpath:this.info.url,tags:""===this.info.tags?"":this.info.tags.join(","),categories:this.info.kind,content:this.value,usecommont:this.info.allowCommont?"on":"off"}).then(function(e){console.log(e),e.ok?400==e.code?t.$Message(e.message):(t.info.id=e.result.data,t.$Message("发布文章成功"),t.$router.replace("/article/history")):t.$Message("服务端错误")})},getKinds:function(){var t=this;e.Article.kinds().then(function(e){e.ok?t.kinds=e.result.data.map(function(e){return e.title=e.name,e.key=e.id,e}):t.$Message("加载分类信息错误")})},initArticle:function(){var e=o.default.state.article;e?(this.value=e.content,this.info.title=e.title,this.info.tags=e.tags,this.info.kind=e.categories,this.info.url=e.subpath,this.info.allowCommont="on"===e.usecommont,this.info.id=e.id,console.log(this.info),o.default.dispatch("updateArticle",null)):this.value="文章简介\n\n\x3c!-- more --\x3e\n\n文章内容"}},mounted:function(){this.getKinds(),this.initArticle();var e=this,t=setInterval(function(){e.$Message({type:"success",text:"保存成功"}),e.onSave(!1)},12e4);this.intervalId=t},beforeDestroy:function(){clearInterval(this.intervalId)}}}).call(t,i(27))},656:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"padding",rawName:"v-padding",value:20,expression:"20"}],staticClass:"app-home"},[i("div",{staticClass:"h-panel"},[i("div",{directives:[{name:"padding",rawName:"v-padding",value:20,expression:"20"}],staticClass:"h-panel-bar"},[e._v("\n            新建文章\n        ")]),e._v(" "),i("div",{directives:[{name:"padding",rawName:"v-padding",value:20,expression:"20"}],staticClass:"h-panel-bar red-color"},[e._v("\n            在写作的过程中不要忘记保存 ( ctrl+s/command+s ) 哦，虽然程序会每隔2分钟自动保存一次！！！\n        ")]),e._v(" "),i("div",{staticClass:"h-panel-body"},[i("div",{staticClass:"h-row"},[i("div",{directives:[{name:"padding",rawName:"v-padding",value:10,expression:"10"}],staticClass:"h-col-6"},[i("Form",{attrs:{labelPosition:"left",labelWidth:100,rules:e.formRules,model:e.info}},[i("FormItem",{attrs:{label:"标题",prop:"title"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.info.title,expression:"info.title"}],attrs:{type:"text",placeholder:"请输入文章标题"},domProps:{value:e.info.title},on:{input:function(t){t.target.composing||e.$set(e.info,"title",t.target.value)}}})]),e._v(" "),i("FormItem",{attrs:{label:"个性化访问",prop:"url"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.info.url,expression:"info.url"}],attrs:{type:"text",placeholder:"个性化访问，如 article1,默认为文章编号"},domProps:{value:e.info.url},on:{input:function(t){t.target.composing||e.$set(e.info,"url",t.target.value)}}})]),e._v(" "),i("FormItem",{attrs:{label:"标签",prop:"tags"}},[i("TagInput",{attrs:{placeholder:"tags",readonly:!1},model:{value:e.info.tags,callback:function(t){e.$set(e.info,"tags",t)},expression:"info.tags"}})],1),e._v(" "),i("FormItem",{attrs:{label:"分类",prop:"kind"}},[i("Select",{attrs:{datas:e.kinds,placeholder:"请选择文章分类"},model:{value:e.info.kind,callback:function(t){e.$set(e.info,"kind",t)},expression:"info.kind"}})],1),e._v(" "),i("FormItem",{attrs:{label:"允许评论",prop:"commont"}},[i("h-switch",{model:{value:e.info.allowCommont,callback:function(t){e.$set(e.info,"allowCommont",t)},expression:"info.allowCommont"}})],1),e._v(" "),i("FormItem",[i("div",{staticClass:"h-btn-group h-btn-group-l"},[i("button",{staticClass:"h-btn h-btn-primary",on:{click:e.submite}},[i("i",{staticClass:"h-icon-outbox"}),i("span",[e._v("发表")])]),e._v(" "),i("button",{staticClass:"h-btn h-btn-blue",on:{click:function(t){e.onSave(!0)}}},[i("i",{staticClass:"h-icon-completed"}),i("span",[e._v("存为草稿")])])])])],1)],1),e._v(" "),i("div",{staticClass:"h-col-18"},[i("mavon-editor",{directives:[{name:"height",rawName:"v-height",value:500,expression:"500"}],attrs:{toolbars:e.toolbars},on:{save:function(t){e.onSave(!1)}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)])])])])},staticRenderFns:[]},e.exports.render._withStripped=!0}});